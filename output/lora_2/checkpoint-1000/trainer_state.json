{
  "best_global_step": 1000,
  "best_metric": 0.8247256875038147,
  "best_model_checkpoint": "/storage/public/liutg/qyguo/qyguo_llm/LoRA/output/lora_2/checkpoint-1000",
  "epoch": 0.7423904974016332,
  "eval_steps": 100,
  "global_step": 1000,
  "is_hyper_param_search": false,
  "is_local_process_zero": true,
  "is_world_process_zero": true,
  "log_history": [
    {
      "entropy": 0.7456053748726845,
      "epoch": 0.014847809948032665,
      "grad_norm": 7.786630153656006,
      "learning_rate": 9.971789161098738e-06,
      "loss": 6.3884,
      "mean_token_accuracy": 0.298332504555583,
      "num_tokens": 43580.0,
      "step": 20
    },
    {
      "entropy": 1.1066458061337472,
      "epoch": 0.02969561989606533,
      "grad_norm": 3.4868600368499756,
      "learning_rate": 9.942093541202672e-06,
      "loss": 3.9298,
      "mean_token_accuracy": 0.4255771193653345,
      "num_tokens": 88611.0,
      "step": 40
    },
    {
      "entropy": 1.4837673127651214,
      "epoch": 0.044543429844097995,
      "grad_norm": 2.224649667739868,
      "learning_rate": 9.912397921306609e-06,
      "loss": 2.6555,
      "mean_token_accuracy": 0.5042739309370518,
      "num_tokens": 131518.0,
      "step": 60
    },
    {
      "entropy": 1.5671665877103806,
      "epoch": 0.05939123979213066,
      "grad_norm": 1.4440240859985352,
      "learning_rate": 9.882702301410543e-06,
      "loss": 1.7594,
      "mean_token_accuracy": 0.6239455044269562,
      "num_tokens": 176230.0,
      "step": 80
    },
    {
      "entropy": 1.1521054908633233,
      "epoch": 0.07423904974016332,
      "grad_norm": 1.0083986520767212,
      "learning_rate": 9.853006681514478e-06,
      "loss": 1.2218,
      "mean_token_accuracy": 0.7556739419698715,
      "num_tokens": 218506.0,
      "step": 100
    },
    {
      "epoch": 0.07423904974016332,
      "eval_entropy": 1.0420655276648392,
      "eval_loss": 1.1408199071884155,
      "eval_mean_token_accuracy": 0.7610522367545134,
      "eval_num_tokens": 218506.0,
      "eval_runtime": 165.1844,
      "eval_samples_per_second": 8.173,
      "eval_steps_per_second": 1.023,
      "step": 100
    },
    {
      "entropy": 1.006733986735344,
      "epoch": 0.08908685968819599,
      "grad_norm": 0.8873780369758606,
      "learning_rate": 9.823311061618413e-06,
      "loss": 1.0729,
      "mean_token_accuracy": 0.7745220147073268,
      "num_tokens": 264296.0,
      "step": 120
    },
    {
      "entropy": 0.9650882937014102,
      "epoch": 0.10393466963622866,
      "grad_norm": 0.5975438952445984,
      "learning_rate": 9.793615441722347e-06,
      "loss": 0.9808,
      "mean_token_accuracy": 0.7899794802069664,
      "num_tokens": 308216.0,
      "step": 140
    },
    {
      "entropy": 0.8844806499779224,
      "epoch": 0.11878247958426132,
      "grad_norm": 0.5805784463882446,
      "learning_rate": 9.76391982182628e-06,
      "loss": 0.8971,
      "mean_token_accuracy": 0.8027060180902481,
      "num_tokens": 352642.0,
      "step": 160
    },
    {
      "entropy": 0.852207538112998,
      "epoch": 0.133630289532294,
      "grad_norm": 0.465183824300766,
      "learning_rate": 9.734224201930217e-06,
      "loss": 0.9107,
      "mean_token_accuracy": 0.8025851443409919,
      "num_tokens": 397500.0,
      "step": 180
    },
    {
      "entropy": 0.8447885058820248,
      "epoch": 0.14847809948032664,
      "grad_norm": 0.5709537863731384,
      "learning_rate": 9.704528582034151e-06,
      "loss": 0.9029,
      "mean_token_accuracy": 0.7977189101278782,
      "num_tokens": 443657.0,
      "step": 200
    },
    {
      "epoch": 0.14847809948032664,
      "eval_entropy": 0.8309441498045386,
      "eval_loss": 0.8726043701171875,
      "eval_mean_token_accuracy": 0.8023634478890684,
      "eval_num_tokens": 443657.0,
      "eval_runtime": 164.8566,
      "eval_samples_per_second": 8.189,
      "eval_steps_per_second": 1.025,
      "step": 200
    },
    {
      "entropy": 0.7790567722171545,
      "epoch": 0.1633259094283593,
      "grad_norm": 0.4691394567489624,
      "learning_rate": 9.674832962138086e-06,
      "loss": 0.8305,
      "mean_token_accuracy": 0.8137287639081479,
      "num_tokens": 488034.0,
      "step": 220
    },
    {
      "entropy": 0.8020077809691429,
      "epoch": 0.17817371937639198,
      "grad_norm": 0.5738286972045898,
      "learning_rate": 9.64513734224202e-06,
      "loss": 0.8751,
      "mean_token_accuracy": 0.808315297216177,
      "num_tokens": 532471.0,
      "step": 240
    },
    {
      "entropy": 0.8375468876212835,
      "epoch": 0.19302152932442465,
      "grad_norm": 0.6597409844398499,
      "learning_rate": 9.615441722345955e-06,
      "loss": 0.877,
      "mean_token_accuracy": 0.803687396645546,
      "num_tokens": 577660.0,
      "step": 260
    },
    {
      "entropy": 0.8238490737974644,
      "epoch": 0.20786933927245732,
      "grad_norm": 0.6164023876190186,
      "learning_rate": 9.58574610244989e-06,
      "loss": 0.8882,
      "mean_token_accuracy": 0.8062053561210633,
      "num_tokens": 623604.0,
      "step": 280
    },
    {
      "entropy": 0.750568987801671,
      "epoch": 0.22271714922049,
      "grad_norm": 0.8762155771255493,
      "learning_rate": 9.556050482553823e-06,
      "loss": 0.7885,
      "mean_token_accuracy": 0.8194963097572326,
      "num_tokens": 667769.0,
      "step": 300
    },
    {
      "epoch": 0.22271714922049,
      "eval_entropy": 0.8102935450316886,
      "eval_loss": 0.855729341506958,
      "eval_mean_token_accuracy": 0.8051525745871504,
      "eval_num_tokens": 667769.0,
      "eval_runtime": 165.1239,
      "eval_samples_per_second": 8.176,
      "eval_steps_per_second": 1.023,
      "step": 300
    },
    {
      "entropy": 0.7274232618510723,
      "epoch": 0.23756495916852263,
      "grad_norm": 0.5860746502876282,
      "learning_rate": 9.526354862657759e-06,
      "loss": 0.7554,
      "mean_token_accuracy": 0.824628034234047,
      "num_tokens": 711229.0,
      "step": 320
    },
    {
      "entropy": 0.7847787939012051,
      "epoch": 0.2524127691165553,
      "grad_norm": 0.46580609679222107,
      "learning_rate": 9.496659242761694e-06,
      "loss": 0.8308,
      "mean_token_accuracy": 0.8131423607468605,
      "num_tokens": 755379.0,
      "step": 340
    },
    {
      "entropy": 0.7973585825413465,
      "epoch": 0.267260579064588,
      "grad_norm": 0.5893098711967468,
      "learning_rate": 9.466963622865628e-06,
      "loss": 0.8382,
      "mean_token_accuracy": 0.8105173215270043,
      "num_tokens": 800465.0,
      "step": 360
    },
    {
      "entropy": 0.7986730515956879,
      "epoch": 0.28210838901262064,
      "grad_norm": 0.782930314540863,
      "learning_rate": 9.437268002969563e-06,
      "loss": 0.8272,
      "mean_token_accuracy": 0.8147882357239723,
      "num_tokens": 844683.0,
      "step": 380
    },
    {
      "entropy": 0.7595947209745646,
      "epoch": 0.2969561989606533,
      "grad_norm": 0.47153863310813904,
      "learning_rate": 9.407572383073498e-06,
      "loss": 0.7866,
      "mean_token_accuracy": 0.8225181877613068,
      "num_tokens": 888540.0,
      "step": 400
    },
    {
      "epoch": 0.2969561989606533,
      "eval_entropy": 0.8274638120239303,
      "eval_loss": 0.8453595042228699,
      "eval_mean_token_accuracy": 0.8073008741147419,
      "eval_num_tokens": 888540.0,
      "eval_runtime": 164.919,
      "eval_samples_per_second": 8.186,
      "eval_steps_per_second": 1.025,
      "step": 400
    },
    {
      "entropy": 0.8218891065567732,
      "epoch": 0.311804008908686,
      "grad_norm": 0.6472597122192383,
      "learning_rate": 9.377876763177432e-06,
      "loss": 0.8496,
      "mean_token_accuracy": 0.8072187811136246,
      "num_tokens": 932915.0,
      "step": 420
    },
    {
      "entropy": 0.8218187320977449,
      "epoch": 0.3266518188567186,
      "grad_norm": 0.45816558599472046,
      "learning_rate": 9.348181143281367e-06,
      "loss": 0.8401,
      "mean_token_accuracy": 0.8126422986388206,
      "num_tokens": 977568.0,
      "step": 440
    },
    {
      "entropy": 0.7913272209465504,
      "epoch": 0.3414996288047513,
      "grad_norm": 0.5337861180305481,
      "learning_rate": 9.318485523385302e-06,
      "loss": 0.8247,
      "mean_token_accuracy": 0.8177659481763839,
      "num_tokens": 1021210.0,
      "step": 460
    },
    {
      "entropy": 0.9198065049946308,
      "epoch": 0.35634743875278396,
      "grad_norm": 0.48815682530403137,
      "learning_rate": 9.288789903489236e-06,
      "loss": 0.955,
      "mean_token_accuracy": 0.7909020788967609,
      "num_tokens": 1067988.0,
      "step": 480
    },
    {
      "entropy": 0.8524567857384682,
      "epoch": 0.3711952487008166,
      "grad_norm": 0.6677752137184143,
      "learning_rate": 9.259094283593171e-06,
      "loss": 0.8783,
      "mean_token_accuracy": 0.8049357913434505,
      "num_tokens": 1112657.0,
      "step": 500
    },
    {
      "epoch": 0.3711952487008166,
      "eval_entropy": 0.832274658792823,
      "eval_loss": 0.8399783968925476,
      "eval_mean_token_accuracy": 0.8071841043833445,
      "eval_num_tokens": 1112657.0,
      "eval_runtime": 165.1315,
      "eval_samples_per_second": 8.175,
      "eval_steps_per_second": 1.023,
      "step": 500
    },
    {
      "entropy": 0.7996046341955662,
      "epoch": 0.3860430586488493,
      "grad_norm": 0.6030681133270264,
      "learning_rate": 9.229398663697106e-06,
      "loss": 0.8237,
      "mean_token_accuracy": 0.8139029458165169,
      "num_tokens": 1157041.0,
      "step": 520
    },
    {
      "entropy": 0.854513456299901,
      "epoch": 0.40089086859688194,
      "grad_norm": 0.4341675639152527,
      "learning_rate": 9.19970304380104e-06,
      "loss": 0.8838,
      "mean_token_accuracy": 0.8049869671463966,
      "num_tokens": 1202291.0,
      "step": 540
    },
    {
      "entropy": 0.8013893313705921,
      "epoch": 0.41573867854491464,
      "grad_norm": 0.5925906896591187,
      "learning_rate": 9.170007423904975e-06,
      "loss": 0.8228,
      "mean_token_accuracy": 0.8162615403532982,
      "num_tokens": 1246129.0,
      "step": 560
    },
    {
      "entropy": 0.8302282769232988,
      "epoch": 0.4305864884929473,
      "grad_norm": 0.48330962657928467,
      "learning_rate": 9.14031180400891e-06,
      "loss": 0.8351,
      "mean_token_accuracy": 0.8117524661123753,
      "num_tokens": 1290698.0,
      "step": 580
    },
    {
      "entropy": 0.7757899068295956,
      "epoch": 0.44543429844098,
      "grad_norm": 0.7127655744552612,
      "learning_rate": 9.110616184112844e-06,
      "loss": 0.808,
      "mean_token_accuracy": 0.8209095194935798,
      "num_tokens": 1334957.0,
      "step": 600
    },
    {
      "epoch": 0.44543429844098,
      "eval_entropy": 0.826873649154189,
      "eval_loss": 0.8358065485954285,
      "eval_mean_token_accuracy": 0.8087237445560432,
      "eval_num_tokens": 1334957.0,
      "eval_runtime": 165.2342,
      "eval_samples_per_second": 8.17,
      "eval_steps_per_second": 1.023,
      "step": 600
    },
    {
      "entropy": 0.8038300912827253,
      "epoch": 0.4602821083890126,
      "grad_norm": 0.5025464296340942,
      "learning_rate": 9.080920564216779e-06,
      "loss": 0.822,
      "mean_token_accuracy": 0.814815204590559,
      "num_tokens": 1379544.0,
      "step": 620
    },
    {
      "entropy": 0.8224337384104728,
      "epoch": 0.47512991833704527,
      "grad_norm": 0.4674902558326721,
      "learning_rate": 9.051224944320713e-06,
      "loss": 0.846,
      "mean_token_accuracy": 0.80881207883358,
      "num_tokens": 1424634.0,
      "step": 640
    },
    {
      "entropy": 0.8162367224693299,
      "epoch": 0.48997772828507796,
      "grad_norm": 0.5125563144683838,
      "learning_rate": 9.021529324424648e-06,
      "loss": 0.8229,
      "mean_token_accuracy": 0.8141455158591271,
      "num_tokens": 1468461.0,
      "step": 660
    },
    {
      "entropy": 0.8364432640373707,
      "epoch": 0.5048255382331106,
      "grad_norm": 0.586670458316803,
      "learning_rate": 8.991833704528583e-06,
      "loss": 0.8606,
      "mean_token_accuracy": 0.8094295665621758,
      "num_tokens": 1513073.0,
      "step": 680
    },
    {
      "entropy": 0.814989049360156,
      "epoch": 0.5196733481811433,
      "grad_norm": 0.47618192434310913,
      "learning_rate": 8.962138084632517e-06,
      "loss": 0.8265,
      "mean_token_accuracy": 0.8181979566812515,
      "num_tokens": 1556347.0,
      "step": 700
    },
    {
      "epoch": 0.5196733481811433,
      "eval_entropy": 0.8324019478622978,
      "eval_loss": 0.8318632245063782,
      "eval_mean_token_accuracy": 0.8096259719521336,
      "eval_num_tokens": 1556347.0,
      "eval_runtime": 165.5867,
      "eval_samples_per_second": 8.153,
      "eval_steps_per_second": 1.021,
      "step": 700
    },
    {
      "entropy": 0.798312297090888,
      "epoch": 0.534521158129176,
      "grad_norm": 0.5249818563461304,
      "learning_rate": 8.932442464736452e-06,
      "loss": 0.8145,
      "mean_token_accuracy": 0.8185075096786022,
      "num_tokens": 1600158.0,
      "step": 720
    },
    {
      "entropy": 0.7985190048813819,
      "epoch": 0.5493689680772086,
      "grad_norm": 0.6330469846725464,
      "learning_rate": 8.902746844840387e-06,
      "loss": 0.7982,
      "mean_token_accuracy": 0.818468426913023,
      "num_tokens": 1644039.0,
      "step": 740
    },
    {
      "entropy": 0.7947610594332218,
      "epoch": 0.5642167780252413,
      "grad_norm": 0.8082268834114075,
      "learning_rate": 8.873051224944321e-06,
      "loss": 0.8097,
      "mean_token_accuracy": 0.8176016040146351,
      "num_tokens": 1688617.0,
      "step": 760
    },
    {
      "entropy": 0.7782666005194188,
      "epoch": 0.579064587973274,
      "grad_norm": 0.4287829101085663,
      "learning_rate": 8.843355605048256e-06,
      "loss": 0.7936,
      "mean_token_accuracy": 0.8225984558463096,
      "num_tokens": 1732258.0,
      "step": 780
    },
    {
      "entropy": 0.792866674810648,
      "epoch": 0.5939123979213066,
      "grad_norm": 0.5466700792312622,
      "learning_rate": 8.81365998515219e-06,
      "loss": 0.8037,
      "mean_token_accuracy": 0.8197148688137531,
      "num_tokens": 1775841.0,
      "step": 800
    },
    {
      "epoch": 0.5939123979213066,
      "eval_entropy": 0.8272358129715779,
      "eval_loss": 0.8294221758842468,
      "eval_mean_token_accuracy": 0.8097981461406459,
      "eval_num_tokens": 1775841.0,
      "eval_runtime": 165.4812,
      "eval_samples_per_second": 8.158,
      "eval_steps_per_second": 1.021,
      "step": 800
    },
    {
      "entropy": 0.8066521011292934,
      "epoch": 0.6087602078693393,
      "grad_norm": 0.7339906096458435,
      "learning_rate": 8.783964365256125e-06,
      "loss": 0.8189,
      "mean_token_accuracy": 0.8149978272616863,
      "num_tokens": 1820213.0,
      "step": 820
    },
    {
      "entropy": 0.8759087789803743,
      "epoch": 0.623608017817372,
      "grad_norm": 0.5280604958534241,
      "learning_rate": 8.75426874536006e-06,
      "loss": 0.905,
      "mean_token_accuracy": 0.8031141817569732,
      "num_tokens": 1866185.0,
      "step": 840
    },
    {
      "entropy": 0.8265287227928638,
      "epoch": 0.6384558277654045,
      "grad_norm": 0.5784000754356384,
      "learning_rate": 8.724573125463995e-06,
      "loss": 0.8302,
      "mean_token_accuracy": 0.8116296142339706,
      "num_tokens": 1910350.0,
      "step": 860
    },
    {
      "entropy": 0.7866755608469248,
      "epoch": 0.6533036377134372,
      "grad_norm": 0.5749318599700928,
      "learning_rate": 8.69487750556793e-06,
      "loss": 0.7973,
      "mean_token_accuracy": 0.8188939988613129,
      "num_tokens": 1954120.0,
      "step": 880
    },
    {
      "entropy": 0.8532539207488299,
      "epoch": 0.6681514476614699,
      "grad_norm": 0.4537442922592163,
      "learning_rate": 8.665181885671864e-06,
      "loss": 0.8764,
      "mean_token_accuracy": 0.8074791327118873,
      "num_tokens": 1998604.0,
      "step": 900
    },
    {
      "epoch": 0.6681514476614699,
      "eval_entropy": 0.8268403058221354,
      "eval_loss": 0.8264369964599609,
      "eval_mean_token_accuracy": 0.8101602852697203,
      "eval_num_tokens": 1998604.0,
      "eval_runtime": 165.3603,
      "eval_samples_per_second": 8.164,
      "eval_steps_per_second": 1.022,
      "step": 900
    },
    {
      "entropy": 0.7859323840588331,
      "epoch": 0.6829992576095026,
      "grad_norm": 0.6036092042922974,
      "learning_rate": 8.635486265775799e-06,
      "loss": 0.8127,
      "mean_token_accuracy": 0.815772820264101,
      "num_tokens": 2043225.0,
      "step": 920
    },
    {
      "entropy": 0.8008639220148325,
      "epoch": 0.6978470675575352,
      "grad_norm": 0.5190542936325073,
      "learning_rate": 8.605790645879733e-06,
      "loss": 0.8188,
      "mean_token_accuracy": 0.8177967943251133,
      "num_tokens": 2087154.0,
      "step": 940
    },
    {
      "entropy": 0.8254318404942751,
      "epoch": 0.7126948775055679,
      "grad_norm": 0.48206865787506104,
      "learning_rate": 8.576095025983668e-06,
      "loss": 0.8373,
      "mean_token_accuracy": 0.8137555561959744,
      "num_tokens": 2131199.0,
      "step": 960
    },
    {
      "entropy": 0.7713548108935356,
      "epoch": 0.7275426874536006,
      "grad_norm": 0.47482872009277344,
      "learning_rate": 8.546399406087602e-06,
      "loss": 0.7702,
      "mean_token_accuracy": 0.8216138035058975,
      "num_tokens": 2174946.0,
      "step": 980
    },
    {
      "entropy": 0.843107944726944,
      "epoch": 0.7423904974016332,
      "grad_norm": 0.4157940745353699,
      "learning_rate": 8.516703786191537e-06,
      "loss": 0.864,
      "mean_token_accuracy": 0.8085492379963398,
      "num_tokens": 2219658.0,
      "step": 1000
    },
    {
      "epoch": 0.7423904974016332,
      "eval_entropy": 0.8344217366015417,
      "eval_loss": 0.8247256875038147,
      "eval_mean_token_accuracy": 0.8104007053657396,
      "eval_num_tokens": 2219658.0,
      "eval_runtime": 165.3141,
      "eval_samples_per_second": 8.166,
      "eval_steps_per_second": 1.022,
      "step": 1000
    }
  ],
  "logging_steps": 20,
  "max_steps": 6735,
  "num_input_tokens_seen": 0,
  "num_train_epochs": 5,
  "save_steps": 100,
  "stateful_callbacks": {
    "EarlyStoppingCallback": {
      "args": {
        "early_stopping_patience": 5,
        "early_stopping_threshold": 0.0
      },
      "attributes": {
        "early_stopping_patience_counter": 0
      }
    },
    "TrainerControl": {
      "args": {
        "should_epoch_stop": false,
        "should_evaluate": false,
        "should_log": false,
        "should_save": true,
        "should_training_stop": false
      },
      "attributes": {}
    }
  },
  "total_flos": 1.0643944836041933e+17,
  "train_batch_size": 2,
  "trial_name": null,
  "trial_params": null
}
